class l{constructor(t){this.el=t,this.markers=[],this.mapEl=this.el.querySelector(".otomaties-store-locator__map"),this.filtersEl=this.el.querySelector(".otomaties-store-locator__filters"),this.options={zoom:parseInt(t.getAttribute("data-zoom"))},this.renderMap(),this.bindEvents()}getMarkersFromHtml(){let t=[];const e=this.mapEl.querySelectorAll(".store");return Array.from(e).forEach(s=>{const o=s.getAttribute("data-lat"),r=s.getAttribute("data-lng");t.push({latLng:new google.maps.LatLng(o,r),title:s.getAttribute("data-title"),content:s.innerHTML,icon:s.getAttribute("data-marker"),categories:s.getAttribute("data-categories").split(",").map(Number)})}),t}renderMap(){const t=this.getMarkersFromHtml();this.map=new google.maps.Map(this.mapEl,{zoom:this.options.zoom,center:new google.maps.LatLng(50.85045,4.34878),mapTypeId:google.maps.MapTypeId.ROADMAP});for(let e=0;e<t.length;e++){let s=new google.maps.Marker({position:t[e].latLng,icon:t[e].icon?t[e].icon:null,map:this.map,categories:t[e].categories});const o=new google.maps.InfoWindow;google.maps.event.addListener(s,"click",function(r,n){return function(){o.setContent(t[n].content),o.open(this.map,r)}}(s,e)),this.markers.push(s)}this.centerMap()}centerMap(){let t=this.markers.filter(o=>o.map!==null);t.length||(t=this.markers);for(var e=new google.maps.LatLngBounds,s=0;s<t.length;s++){const o=t[s].position;e.extend(o)}t.length>1?this.map.fitBounds(e):this.map.setCenter(e.getCenter())}bindEvents(){this.filtersEl.addEventListener("change",()=>{const t=this.filtersEl.querySelectorAll('input[type="checkbox"]'),e=Array.from(t).filter(s=>s.checked).map(s=>parseInt(s.value));this.filter(e)})}filter(t){for(let e=0;e<this.markers.length;e++)!t.length||this.markers[e].categories.filter(s=>t.includes(s)).length?this.markers[e].setMap(this.map):this.markers[e].setMap(null);this.centerMap()}}const i=document.querySelectorAll(".otomaties-store-locator");i.length&&i.forEach(a=>{new l(a)});
